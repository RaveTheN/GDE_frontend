<nb-card>
  <nb-card-body>
    <nb-stepper #stepper (stepChange)="onStepChange($event)">
      <nb-step [stepControl]="firstForm" label="Select city">
        <form [formGroup]="firstForm" class="step-container">
          <div class="input-group" [class.spinner]="loading">
            <div>
              <p>Select the city to apply filters to:</p>
              <p
                [hidden]="
                  citySelected === false || firstForm.status === 'VALID'
                "
                class="alert"
              >
                Please select a city first:
              </p>
              <nb-radio-group
                formControlName="cityOptions"
                [(ngModel)]="option"
              >
                <nb-radio
                  [disabled]="loading"
                  *ngFor="let option of options"
                  [value]="option.value"
                >
                  {{ option.label }}
                </nb-radio>
              </nb-radio-group>
            </div>
          </div>
          <a href="pages/available-options"
            ><button type="button" nbButton [disabled]="loading">
              prev
            </button></a
          >
          <button
            type="button"
            nbButton
            [disabled]="loading"
            (click)="onFirstSubmit()"
          >
            next
          </button>
        </form>
      </nb-step>
      <nb-step [stepControl]="secondForm" label="Apply filters">
        <form
          [formGroup]="secondForm"
          (ngSubmit)="onSecondSubmit()"
          class="step-container"
        >
          <div
            class="form-check"
            *ngFor="let filter of filters"
            style="display: flex"
          >
            <nb-checkbox
              formControlName="filters"
              (change)="onChange(filter)"
              >{{ filter }}</nb-checkbox
            >
          </div>
          <p
            [hidden]="filterSelected === false || secondForm.status === 'VALID'"
            class="alert"
          >
            Select at least one of the above filters
          </p>
          <p
            [hidden]="filterSelected === false || secondForm.status === 'VALID'"
            class="alert"
          >
            Draw area in which to search
          </p>
          <div (click)="checkDrawing()" class="map-container">
            <div class="map-frame">
              <div id="map"></div>
            </div>
          </div>
          <button type="button" nbButton nbStepperPrevious (click)="(clearMap)">
            prev
          </button>
          <button
            type="button"
            (click)="onSecondSubmit()"
            (click)="(clearMap)"
            nbButton
          >
            next
          </button>
        </form>
      </nb-step>
      <nb-step label="Results">
        <p class="lorem">
          The markers in the map shows the points matching your search criteria.
          Proceed to next step, to save this result.
        </p>
        <div class="map-container">
          <div class="map-frame">
            <div id="map"></div>
          </div>
        </div>
        <button nbButton nbStepperPrevious>prev</button>
        <button nbButton nbStepperNext>next</button>
      </nb-step>
      <nb-step [stepControl]="thirdForm" label="Save search"
        ><form
          [formGroup]="thirdForm"
          (ngSubmit)="onThirdSubmit()"
          class="step-container"
        >
          <div class="input-group">
            <div>
              <p>Project's name:</p>
              <input
                nbInput
                type="text"
                placeholder="Project's name"
                class="form-control"
                formControlName="projectName"
                [ngClass]="{
                  'form-control-danger':
                    firstForm.invalid && (firstForm.dirty || firstForm.touched)
                }"
              />
            </div>
            <div>
              <p>Description:</p>
              <textarea
                nbInput
                type="text"
                placeholder="Description"
                formControlName="description"
              ></textarea>
            </div>
          </div>
          <button nbButton nbStepperPrevious>prev</button>
          <a href="pages/available-options"
            ><button
              [disabled]="thirdForm.value.projectName === ''"
              type="button"
              nbButton
            >
              Save
            </button></a
          >
        </form>
      </nb-step>
    </nb-stepper>
  </nb-card-body>
</nb-card>
